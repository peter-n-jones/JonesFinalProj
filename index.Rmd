---
title: "Gov 50 Final Project"
author: "Peter Jones"
description: "Separatist Region Concessions"
output:
  distill::distill_article:
    self_contained: false
---

#Proposal

Does freedom of expression and association under a state's central government affect the likelihood that it will have to make autonomy concessions to self-determination movements? In this study, I seek to gain a deeper understanding of the conditions under which self-determination movements (SDMs) in pursuit of sovereignty are more likely to succeed in gaining autonomy concessions from their central governments. It strikes me that a free civil society (for which I will use free-association and -press index scores across times) may serve as a double-edged sword in the context of SDM success. On the one hand, more democratized flow of information likely makes it easier for separatist agents to mobilize, coordinate, and put their ideas into action. On the other hand, repressed civil societies raise the costs of inaction to SDM participants and may therefore incentivize more extreme tactics that are more likely to extract concessions from central governments. My hypothesis is that freer civil societies are more conducive to central government concessions, most likely because there are lesser audience costs in repressive autocracies. 

The explanatory variables I anticipate analyzing across individual SDMs that make sovereignty declarations — those being my unit of analysis — are their central government's press freedom and assembly freedom index scores at the onset of the conflict (as determined by Reporters Sans Frontieres), and whether or not separatists employed violence. My outcome variable of interest is whether or not the central government made either an "autonomy" concession or an "independence" concession. 

I will use a couple available datasets to conduct this analysis. The most important one is Nicholas Sambanis's, Micha Germann's, and Andreas Schädel's 2018 dataset on Self-Determination Movements from the Journal of Conflict Resolution. This dataset contains every movement between 1945 and 2012 that fits the definition of "movements by one or more political organizations that are connected to an ethnic group and make claims for increased SD from the state." This set contains binary variables for concessions and violence, as well as the dates of the movement, and whether or not it made a sovereignty declaration. I will then use Reporters Sans Frontieres' press freedom index, which it has published since 2002, to extract the press and assembly freedom index scores. While I hope to find some kind of proxy measure for movements between 1945 and 2002, I may just have to make it an analysis of the final decade of the Sambanis data, which I am comfortable with.

A result indicating that SDMs in freer civil societies are less likely to succeed would counter my hypothesis; the converse would confirm it. I am hoping that the breadth of data is wide enough such that I can control for factors like geography and GDP as well; if possible, this would make me more confident in the final result of my analysis.

#Milestone 3

#Data Loading 

```{r}
library(tidyverse)
library(broom)

SDM <- read.csv("/Users/peterjones/JonesFinalProj/SDM.csv")

```


#Data Visualization

For my first data visualation, I have produced a histogram of the number of successful or semi-successful separatist movements over time. This is an important first test as I look to the other variable I am tracking (media freedom index score), as I will have to closely match the parameters on separatist movement start dates with the timing aspect of the media freedom index scores. I still need to establish how exactly I will tie these data sets together — ie, should I tie the movements to the media freedom index in the year in which they began (this will limit my scope to movements beginning since 2002, which is too limiting) or the year in which they ended (this will limit me to movements that have concluded, though for ongoing movements I could probably just use the current index, perhaps).

```{r}
  #check parameters of data
  sum(SDM$indcon, na.rm=TRUE)
  sum(SDM$autcon, na.rm=TRUE)
  max(SDM$year)
  
SDMcon <- SDM |>
  filter(con == 1) |>
  filter(year > 1979)

ggplot(data=SDMcon, aes(x=year)) + 
  geom_histogram(binwidth = 1, fill = "blue", color = "black") +
  labs(
    title = "Successful or Semi-Successful Separatist Movements by Year",
    x = "Year",
    y = "Number of Movements",
    caption = "Where 'Successful' is defined as a concession of independence, and 
  'Semi-Successful' is defined as a significant autonomy concession."
  ) +
  theme_minimal() 

  
```


#First Analysis

First I will join the Self-Determination movement data with  Freedom House press index scores. This includes doing some clean-up work to fix NAs that erroneously emerge from different place labels for some countries like Russia/USSR. There's some weird stuff happening with Hungarians in Yugoslavia, coded for a period after Yugoslavia didn't even exist anymore, that I'll have to fix later. The press freedom data codes a "0" for no press freedom, a "1" for partial freedom, and a "2" for full freedom.


```{r}

freedom <- read_csv("press-freedom-fh.csv")
freedom$Entity[freedom$Entity == "Russia"] <- "Russia (USSR)"

#join with press freedom
SDMcon_freedom <- merge(SDMcon, freedom, by.x = c("country", "year"), by.y = c("Entity", "Year"), all.x = TRUE)
#move freedom up 
SDMcon_freedom <- SDMcon_freedom[, c(1:6, 108, 7:107)]
View(SDMcon_freedom)
```

For my first analysis, I will now make a bar chart of all the successful SDM movements based on whether they took place under governments that were free-press, partially free-press, or not free at all. Some data still needs to be cleaned and it remains to be seen whether or not the likelihood of success was affected (since this doesn't include unsuccessful movements), but this should provide a good visual starting-off point. 

```{r}

ggplot(SDMcon_freedom, aes(x = `Freedom of the Press`)) +
  geom_bar (color = "blue", fill = "skyblue") + 
  labs(title = "Successful (incl. partial) SDMs by Press Freedom", 
       x = "Freedom Level",
       y = "Quantity") 
```


#### From Here Down: Working on Write-Up


```{r}
## New question: Does the effect of internet usage (benchmark: 15% pop) on separatist movement success vary among states with repressed, semi-free, and free media environments?


##1. merging non-successful movements too with press freedom

freedom <- read_csv("press-freedom-fh.csv")
freedom$Entity[freedom$Entity == "Russia"] <- "Russia (USSR)"

SDM_freedom <- merge(SDM, freedom, by.x = c("country", "year"), by.y = c("Entity", "Year"), all.x = TRUE)
SDM_freedom <- SDM_freedom |>
    filter(year > 1979) |>
    filter(!is.na(con)) |>
    rename(press_freedom = "Freedom of the Press")
#move freedom up 
SDM_freedom <- SDM_freedom[, c(1:6, 108, 7:107)]
#View(SDM_freedom)
#see how movements look over time

ggplot(data=SDM_freedom, aes(x=year)) + 
  geom_histogram(binwidth = 1, fill = "blue", color = "black") +
  labs(
    title = "Separatist Movements by Year",
    x = "Year",
    y = "Number of Movements") +
  theme_minimal() 

##2. New DF with biyearly "success rate" by level of press freedom

SDM_freedom_2yr <- SDM_freedom |>
  mutate(period = cut(year, breaks = seq(1980, max(year) + 2, by = 2), include.lowest = TRUE, labels = FALSE))

SDM_freedomlevel_successrate <- SDM_freedom_2yr |>
  group_by(press_freedom, period) |>
  summarize(success_rate = mean(con))

SDM_freedomlevel_successrate <- SDM_freedomlevel_successrate |>
    filter(!is.na(press_freedom)) 


SDM_freedomlevel_successrate$press_freedom <- as.factor(SDM_freedomlevel_successrate$press_freedom)

# lets see how the levels look

ggplot(SDM_freedomlevel_successrate, aes(x = period, y = success_rate, color = press_freedom)) +
  geom_line() +
  labs(title = "Success Rate Over Time by Press Freedom Level",
       x = "Year",
       y = "Success Rate") +
  scale_color_manual(values = c("blue", "green", "red"))

```



```{r}
##okay...now lets group in the internet usage dataset to SDM_freedom

internet <- read_csv("internet_usage.csv")

internet_benchmark <- internet |>
  rename(usage_rate = "Individuals using the Internet (% of population)") |>
  rename(benchmark_year = "Year") |>
  group_by(Entity) |>
  filter(benchmark_year == min(benchmark_year[usage_rate >= 0.15])) |>
  slice(1)

internet_benchmark <- internet_benchmark |>
  filter(!is.na(Code)) |>
  filter(usage_rate < 1)

  #note: need to fix erroneous rates that are off by 2 decimal places, e.g. Latvia


#create distance in years variable from internet usage variable to "anchor" SDMs

SDM_freedom_internet <- left_join(SDM_freedom, internet_benchmark, by = c("Code" = "Code"))

SDM_freedom_internet <- SDM_freedom_internet |>
  mutate(bench_dist = year - benchmark_year)

SDM_freedomlevel_internet_successrate <- SDM_freedom_internet |>
  group_by(press_freedom, bench_dist) |>
  filter(!is.na(bench_dist)) |>
  filter(bench_dist <= 10 & bench_dist >= -10) |>
  summarize(success_rate = mean(con)) 

```

Now try with LMs

```{r}
ggplot(SDM_freedomlevel_internet_successrate, aes(x = bench_dist, y = success_rate, color = factor(press_freedom))) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Success Rate Across Years, Centered Around Benchmark",
       x = "Years from Benchmark",
       y = "Success Rate",
       color = "Press Freedom Level") +
  scale_color_manual(values = c("red", "orange", "darkgreen")) +  # Customize colors if needed
  theme_minimal()
```


```{r}
#Is difference between suppressed/semi-suppressed and free relative to internet usage?
# That is, does overall press freedom have a significant differential effect relative to internet takeup?

# merge success rates

surpressed_successrate <- SDM_freedomlevel_internet_successrate |>
  filter(press_freedom %in% c(1, 0)) |>
  group_by(bench_dist) |>
  summarise(success_rate = mean(success_rate))

SDM_successrate_merged <- SDM_freedomlevel_internet_successrate |>
  filter(press_freedom == 2) |>
  right_join(surpressed_successrate, by = "bench_dist") 

SDM_successrate_merged <- SDM_successrate_merged |>
  ungroup() |>
  select(-press_freedom) |>
  rename(Free_Success_Rate = success_rate.x, Unfree_Success_Rate = success_rate.y)
  
SDM_successrate_merged
  
#Run regressions 

mod_free <- lm(data = SDM_successrate_merged, Free_Success_Rate ~ bench_dist)
mod_unfree <-lm(data = SDM_successrate_merged, Unfree_Success_Rate ~ bench_dist)

summary(mod_free)
summary(mod_unfree)

#Make Table

coefs_free <- tidy(mod_free)
coefs_unfree <- tidy(mod_unfree)

coefs_free$Model <- "Free"
coefs_unfree$Model <- "Unfree"

freeunfree_table <- bind_rows(coefs_free, coefs_unfree) |>
  select(Model, term, estimate, std.error, statistic, p.value)

# Print the result table
knitr::kable(freeunfree_table) #still need to fix col names

confint(mod_free, 'bench_dist', level=0.95)
confint(mod_unfree, 'bench_dist', level=0.95)

```

#Introduction 
















